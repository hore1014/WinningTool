<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="keywords" content="HTML, CSS" />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
    <meta
      name="description"
      content="Mit dem Supply Chain Planer werden Bestellungen, Lagerhaltung, die Produktion und der Absatz geplant"
    />
    <title>Sales Prediction, Stock and Production Planer</title>
  </head>
  <body>
    <nav>
      <ul class="progressbar">
        <li class="active">
          <a href="1_lastPeriod.html">Vorherige Periode</a>
        </li>
        <li class="active">
          <a href="2_salesPrediction.html"
            >Absatz-Prognosen und Produktionsplan</a
          >
        </li>
        <li>
          <a href="3_stockPlaner.html"
            >Lager und Produktion der Zwischenerzeugnisse</a
          >
        </li>
        <li>
          <a href="4_productionSequence.html"
            >Produktionsreihenfolge und Splitting</a
          >
        </li>
        <li><a href="5_orders_purchase.html">Bestellungen</a></li>
        <li><a href="6_capacity.html">Kapazität</a></li>
        <li><a href="7_finances.html">Finanzen</a></li>
      </ul>
    </nav>

    <form method="post">
      <div class="big-container">
        <!-- Absatz-Prognosen -->
        <h3>
          Geben Sie die Absatzprognosen für die aktuelle und die darauffolgenden
          Perioden an.
        </h3>
        <table id="sales-table">
          <thead>
            <tr>
              <th>Produkte</th>
              <th>Aktuelle Periode</th>
              <th>Aktuell +1</th>
              <th>Aktuell +2</th>
              <th>Aktuell +3</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>P1</td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="sales_P1_0" value="{{ sales_P1_0 }}">
              </td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="sales_P1_1" value="{{ sales_P1_1 }}">
              </td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="sales_P1_2" value="{{ sales_P1_2 }}">
              </td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="sales_P1_3" value="{{ sales_P1_3 }}">
              </td>
            </tr>
            <tr>
              <td>P2</td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="sales_P2_0" value="{{ sales_P2_0 }}">
              </td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="sales_P2_1" value="{{ sales_P2_1 }}">
              </td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="sales_P2_2" value="{{ sales_P2_2 }}">
              </td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="sales_P2_3" value="{{ sales_P2_3 }}">
              </td>
            </tr>
            <tr>
              <td>P3</td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="sales_P3_0" value="{{ sales_P3_0 }}">
              </td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="sales_P3_1" value="{{ sales_P3_1 }}">
              </td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="sales_P3_2" value="{{ sales_P3_2 }}">
              </td>
              <td
                class="editable"
                class="allow-number"              >
               <input type="number" name ="sales_P3_3" value="{{ sales_P3_3 }}">
              </td>
            </tr>
            <tr>
              <td><em>Summe</em></td>
              <td id="sum-0">0</td>
              <td id="sum-1">0</td>
              <td id="sum-2">0</td>
              <td id="sum-3">0</td>
            </tr>
          </tbody>
        </table>

        <!-- Lagerbestände und Produktion -->

        <h3>Geben Sie die Planendlagerbestände der Hauptprodukte an.</h3>
        <p>Daraus ergibt sich der Produktionsplan.</p>
        <table id="stock-and-production-table">
          <col />
          <colgroup span="2"></colgroup>
          <colgroup span="2"></colgroup>
          <thead>
            <tr>
              <th rowspan="2">Produkte</th>
              <th colspan="2">Aktuelle Periode</th>
              <th colspan="2">Aktuell +1</th>
              <th colspan="2">Aktuell +2</th>
              <th colspan="2">Aktuell +3</th>
            </tr>
            <tr>
              <th>Lager</th>
              <th>Produktion</th>
              <th>Lager</th>
              <th>Produktion</th>
              <th>Lager</th>
              <th>Produktion</th>
              <th>Lager</th>
              <th>Produktion</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>P1</td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="stock_P1_0" value="{{ stock_P1_0 }}">
              </td>
              <td id="production_P1_0">0</td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="stock_P1_1" value="{{ stock_P1_1 }}">
              </td>
              <td id="production_P1_1">0</td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="stock_P1_2" value="{{ stock_P1_2 }}">
              </td>
              <td id="production_P1_2">0</td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="stock_P1_3" value="{{ stock_P1_3 }}">
              </td>
              <td id="production_P1_3">0</td>
            </tr>
            <tr>
              <td>P2</td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="stock_P2_0" value="{{ stock_P2_0 }}">
              </td>
              <td id="production_P2_0">0</td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="stock_P2_1" value="{{ stock_P2_1 }}">
              </td>
              <td id="production_P2_1">0</td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="stock_P2_2" value="{{ stock_P2_2 }}">
              </td>
              <td id="production_P2_2">0</td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="stock_P2_3" value="{{ stock_P2_3 }}">
              </td>
              <td id="production_P2_3">0</td>
            </tr>
            <tr>
              <td>P3</td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="stock_P3_0" value="{{ stock_P3_0 }}">
              </td>
              <td id="production_P3_0">0</td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="stock_P3_1" value="{{ stock_P3_1 }}">
              </td>
              <td id="production_P3_1">0</td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="stock_P3_2" value="{{ stock_P3_2 }}">
              </td>
              <td id="production_P3_2">0</td>
              <td
                class="editable"
                class="allow-number"
              >
                <input type="number" name ="stock_P3_3" value="{{ stock_P3_3 }}">
              </td>
              <td id="production_P3_3">0</td>
            </tr>
            <tr>
              <td><em>Summe</em></td>
              <td id="sum-stock-0">0</td>
              <td id="sum-production-0">0</td>
              <td id="sum-stock-1">0</td>
              <td id="sum-production-1">0</td>
              <td id="sum-stock-2">0</td>
              <td id="sum-production-2">0</td>
              <td id="sum-stock-3">0</td>
              <td id="sum-production-3">0</td>
            </tr>
          </tbody>
        </table>
      </div>

      <br class="spacing" />

      <button
        class="continue-button"
        type="submit"
        value="Upload"
        onclick="location.href='3_stockPlaner.html'"
      >
        Weiter
        <img
          id="continue-icon"
          src="{{ url_for('static', filename='img/continueArrow.png') }}"
        />
      </button>
    </form>

    <script>
      calculateForecastSums();
      calculateProductions();
      calculateStockAndProductionSums();

      document.addEventListener("keyup", function (event) {
        calculateForecastSums();
        calculateProductions();
        calculateStockAndProductionSums();
      });
      
      /* Calculate sums in forecast table */
      function calculateForecastSums() {
        var table = document.getElementById("sales-table");

        for (var column = 0; column < 4; column++) {
          var sum = 0;
          var cell = 0;

          for (var row = 1; row < table.rows.length - 1; row++) {
            cell = document.getElementsByName("sales_P" + row + "_" + column)[0].value;
            if (cell.length == 0) {
              sum += 0;
            }
            else {
              sum += parseInt(cell);
            }
          }
          document.getElementById("sum-" + column).innerHTML = sum;
        }
      }

      /* Calculate Production Numbers in Table */
      function calculateProductions() {
        var salesTable = document.getElementById("sales-table");
        var stockAndProductionTable = document.getElementById("stock-and-production-table");
        var salesCell = 0;
        var stockCell = 0;
        var salesNumber = 0;
        var stockNumber = 0;
        var productionNumber = 0;

        for (var column = 0; column < 4; column++) {
          
          for (var row = 1; row < salesTable.rows.length - 1; row++) {
            salesCell = document.getElementsByName("sales_P" + row + "_" + column)[0].value;
            stockCell = document.getElementsByName("stock_P" + row + "_" + column)[0].value;
            if (salesCell.length == 0) {
              salesNumber = 0;
            }
            else {
              salesNumber = parseInt(salesCell);
            }
            if (stockCell.length == 0) {
              stockNumber = 0;
            }
            else {
              stockNumber = parseInt(stockCell);
            }
            productionNumber
          }
        }
      }

      /* Calculate Production and Stock Sums in Table */
      function calculateStockAndProductionSums() {
        var table = document.getElementById("stock-and-production-table");
        var period = 0;

        for (var column = 1; column < 9; column++) {
          var sum = 0;

          for (var row = 2; row < table.rows.length - 1; row++) {
            sum += parseInt(table.rows[row].cells[column].innerHTML);
          }
          if (column % 2 == 1) {
            document.getElementById("sum-stock-" + period).innerHTML = sum;
          } else {
            document.getElementById("sum-production-" + period).innerHTML =
              sum;
            period++;
          }
        }
      }
    </script>

  </body>
  <footer>
    © IbSys2 Projekt von René Hopfe, David Böhm und Amelie Rempel, 2021
  </footer>
</html>
